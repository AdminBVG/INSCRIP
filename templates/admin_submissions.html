{% extends 'base.html' %}
{% block title %}Inscripciones{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Inscripciones recibidas</h1>

<form method="get" class="mb-4">
  <label class="block mb-1">Categor√≠a</label>
  <select name="category" onchange="this.form.submit()" class="border rounded w-full p-2">
    <option value="">-- Todas --</option>
    {% for item in menu %}
      <option value="{{ item.key }}" {% if item.key == selected_cat %}selected{% endif %}>{{ item.name }}</option>
    {% endfor %}
  </select>
</form>

{% if submissions %}
  <div class="space-y-4">
    {% for sub in submissions %}
      <div class="border rounded p-2">
        <h2 class="font-semibold mb-2">{{ sub.category_name }} - {{ sub.created_at }}</h2>
        <ul class="mb-2">
          {% for label, value in sub.fields.items() %}
            <li><strong>{{ label }}:</strong> {{ value }}</li>
          {% endfor %}
        </ul>
        {% if sub.folder_url %}
          <p><strong>Carpeta:</strong> <a href="{{ sub.folder_url }}" class="text-blue-600" target="_blank">{{ sub.folder_url }}</a></p>
        {% endif %}
        {% if sub.files %}
          <ul class="mb-2">
            {% for f in sub.files %}
              <li>{{ f.name }} ({{ f.size }} bytes)</li>
            {% endfor %}
          </ul>
        {% endif %}
        <p><strong>Estado:</strong> {{ sub.status }}{% if sub.error %} - {{ sub.error }}{% endif %}</p>
        {% if sub.user %}<p><strong>Usuario:</strong> {{ sub.user }}</p>{% endif %}
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>No hay inscripciones.</p>
{% endif %}
{% endblock %}
